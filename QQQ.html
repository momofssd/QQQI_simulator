<!doctype html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>QQQI DCA Simulator</title>
    <link rel="stylesheet" href="styles.css" />
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
  </head>
  <body>
    <div class="container">
      <div class="logo-header">
        <div class="logo-text">INVESTMENT CALCULATOR</div>
      </div>
      <h1>QQQI DCA Simulator</h1>
      <p class="subtitle">
        Dividend Reinvestment Calculator with Market Volatility Analysis
      </p>
      <p
        class="subtitle"
        style="
          font-size: 0.85em;
          color: #666;
          margin-top: -20px;
          line-height: 1.5;
        "
      >
        QQQI ROC Tax Treatment: ROC reduces cost basis (tax-deferred) until each
        lot reaches $0. Once depleted, additional ROC becomes taxable capital
        gain with Section 1256 treatment (60% long-term, 40% short-term).
        Default ROC: 14% annually. Set your own sell age for projection end.
      </p>

      <div class="input-grid">
        <div class="input-group">
          <label for="initialBalance">Initial Investment ($)</label>
          <input
            type="number"
            id="initialBalance"
            value="0"
            min="0"
            step="100"
          />
        </div>

        <div class="input-group">
          <label for="qqqiPrice">Current QQQI Price ($)</label>
          <input
            type="number"
            id="qqqiPrice"
            value="50"
            min="0.01"
            step="0.01"
          />
        </div>

        <div class="input-group">
          <label for="monthlyDcaAmount">Monthly DCA Amount ($)</label>
          <input
            type="number"
            id="monthlyDcaAmount"
            value="400"
            min="0"
            step="10"
          />
        </div>

        <div class="input-group">
          <label for="currentAge">Current Age</label>
          <input
            type="number"
            id="currentAge"
            value="39"
            min="18"
            max="100"
            step="1"
          />
        </div>

        <div class="input-group">
          <label for="targetAge">Target Age (Stop DCA & Reinvestment)</label>
          <input
            type="number"
            id="targetAge"
            value="50"
            min="18"
            max="120"
            step="1"
          />
        </div>

        <div class="input-group">
          <label for="sellAge">Sell Age (Cash Out & End Projection)</label>
          <input
            type="number"
            id="sellAge"
            value="60"
            min="18"
            max="120"
            step="1"
          />
        </div>

        <div class="input-group">
          <label for="annualROC">Annual ROC Rate (%)</label>
          <input
            type="number"
            id="annualROC"
            value="14"
            min="0"
            max="100"
            step="0.5"
          />
        </div>

        <div class="input-group">
          <label for="marketTrend">Market Trend</label>
          <select id="marketTrend">
            <option value="neutral">Neutral</option>
            <option value="random" selected>Random (Bullish/Bearish)</option>
            <option value="bullish">Bullish Bias</option>
            <option value="bearish">Bearish Bias</option>
          </select>
        </div>
      </div>

      <div class="button-group">
        <button class="btn-calculate" onclick="calculate()">Calculate</button>
        <button class="btn-reset" onclick="reset()">Reset</button>
      </div>

      <div class="results" id="results">
        <div class="summary-cards">
          <div class="card">
            <div class="card-title">Total Principal</div>
            <div class="card-value" id="totalPrincipal">$0</div>
          </div>
          <div class="card">
            <div class="card-title">Total Invested</div>
            <div class="card-value" id="totalInvested">$0</div>
          </div>
          <div class="card">
            <div class="card-title">Total Gain (Bal + ROC - Prin)</div>
            <div class="card-value" id="totalGain">$0</div>
          </div>
          <div class="card">
            <div class="card-title">Final Balance</div>
            <div class="card-value" id="finalBalance">$0</div>
          </div>
          <div class="card">
            <div class="card-title">Total ROC Received</div>
            <div class="card-value" id="totalROC">$0</div>
          </div>
          <div class="card">
            <div class="card-title">Latest Annual ROC</div>
            <div class="card-value" id="latestAnnualROC">$0</div>
          </div>
          <div class="card">
            <div class="card-title">Tax Deferred</div>
            <div class="card-value" id="totalTaxDeferred">$0</div>
          </div>
          <div class="card">
            <div class="card-title">Tax on ROC</div>
            <div class="card-value" id="totalROCTaxesPaid">$0</div>
          </div>
          <div class="card">
            <div class="card-title">Tax on Sale</div>
            <div class="card-value" id="capitalGainsTax">$0</div>
          </div>
          <div class="card">
            <div class="card-title">Total Taxes Paid</div>
            <div class="card-value" id="totalTaxesPaid">$0</div>
          </div>
          <div class="card">
            <div class="card-title">Final Cost Basis</div>
            <div class="card-value" id="finalCostBasis">$0</div>
          </div>
          <div class="card">
            <div class="card-title">Target Year</div>
            <div class="card-value" id="targetYearDisplay">0</div>
          </div>
          <div class="card">
            <div class="card-title">Average Market Annual Growth</div>
            <div class="card-value" id="avgMarketGrowth">0%</div>
          </div>
          <div class="card">
            <div class="card-title">Total Market Growth</div>
            <div class="card-value" id="totalMarketGrowth">0%</div>
          </div>
        </div>

        <div class="chart-container">
          <canvas id="rocChart"></canvas>
        </div>

        <div style="text-align: right">
          <button class="btn-download" onclick="downloadCSV()">
            Download CSV
          </button>
        </div>

        <div class="year-table">
          <table>
            <thead>
              <tr>
                <th>Month</th>
                <th>Year</th>
                <th>Age</th>
                <th>Shares</th>
                <th>Share Price</th>
                <th>Total Invested</th>
                <th>Total Balance</th>
                <th>Monthly ROC</th>
                <th>Total ROC (Cumul.)</th>
                <th>Tax Deferred</th>
                <th>Tax Paid</th>
                <th>Cost Basis</th>
                <th>Market Trend</th>
              </tr>
            </thead>
            <tbody id="yearTableBody"></tbody>
          </table>
        </div>
      </div>
    </div>

    <script src="script.js"></script>
  </body>
</html>
